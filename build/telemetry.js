!function(){"use strict";var e=window.wp.element,t=window.wp.plugins,n=window.wp.data,r=function(){return(0,e.useEffect)((function(){var e=function(){return(0,n.select)("core/block-editor").getBlocks()},t=new Set(e().map((function(e){return e.clientId}))),r=(0,n.subscribe)((function(){var n=e(),r=new Set(n.map((function(e){return e.clientId})));if(r.size!==t.size)for(var a=r.size>t.size,o=0,c=a?n:Array.from(t);o<c.length;o++){var s=c[o];if(a){var l=s;l.name.startsWith("wp-parsely/")&&!t.has(l.clientId)&&i.trackEvent("block_added",{block:l.name})}else{var u=s;r.has(u)||i.trackEvent("block_removed",{block:u})}}t=r}));return function(){r()}}),[]),null},a=function(){function n(){this._tkq=[],this.isLoaded=!1,this.loadTrackingLibrary()}return n.getInstance=function(){return window.wpParselyTelemetryInstance||Object.defineProperty(window,"wpParselyTelemetryInstance",{value:new n,writable:!1,configurable:!1,enumerable:!1}),window.wpParselyTelemetryInstance},n.prototype.loadTrackingLibrary=function(){var e=this,t=document.createElement("script");t.async=!0,t.src="//stats.wp.com/w.js",t.onload=function(){e.isLoaded=!0,e._tkq=window._tkq||[]},document.head.appendChild(t)},n.prototype.setupEvents=function(){var n=(0,e.createElement)(e.Fragment,null,(0,e.createElement)(r));(0,t.registerPlugin)("wp-parsely-tracks-js-events",{render:function(){return n}})},n.trackEvent=function(e,t){return void 0===t&&(t={}),r=this,a=void 0,o=function(){var r;return function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(o=0)),o;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){o.label=c[1];break}if(6===c[0]&&o.label<a[1]){o.label=a[1],a=c;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(c);break}a[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}}(this,(function(a){switch(a.label){case 0:return r=n.getInstance(),[4,n.waitUntilLoaded()];case 1:return a.sent(),r.trackEvent(e,t),[2]}}))},new((i=void 0)||(i=Promise))((function(e,t){function n(e){try{s(o.next(e))}catch(e){t(e)}}function c(e){try{s(o.throw(e))}catch(e){t(e)}}function s(t){var r;t.done?e(t.value):(r=t.value,r instanceof i?r:new i((function(e){e(r)}))).then(n,c)}s((o=o.apply(r,a||[])).next())}));var r,a,i,o},n.waitUntilLoaded=function(){return new Promise((function(e,t){var r=n.getInstance();if(r.isLoaded)e();else var a=0,i=setInterval((function(){r.isLoaded&&(clearInterval(i),e()),(a+=100)>=1e4&&(clearInterval(i),t("Telemetry library not loaded"))}),100)}))},n.prototype.trackEvent=function(e,t){var r;this.isLoaded?(0!==e.indexOf(n.TRACKS_PREFIX)&&(e=n.TRACKS_PREFIX+e),this.isEventNameValid(e)?(t=this.prepareProperties(t),null===(r=this._tkq)||void 0===r||r.push(["recordEvent",e,t])):console.error("Error tracking event: Invalid event name")):console.error("Error tracking event: Telemetry not loaded")},n.prototype.isProprietyValid=function(e){return n.PROPERTY_REGEX.test(e)},n.prototype.isEventNameValid=function(e){return n.EVENT_NAME_REGEX.test(e)},n.prototype.prepareProperties=function(e){return(e=this.sanitizeProperties(e)).parsely_version=window.wpParselyTracksTelemetry.version,window.wpParselyTracksTelemetry.user&&(e._ut=window.wpParselyTracksTelemetry.user.type,e._ui=window.wpParselyTracksTelemetry.user.id),this.sanitizeProperties(e)},n.prototype.sanitizeProperties=function(e){var t=this,n={};return Object.keys(e).forEach((function(r){t.isProprietyValid(r)&&(n[r]=e[r])})),n},n.TRACKS_PREFIX="wpparsely_",n.EVENT_NAME_REGEX=/^(([a-z0-9]+)_){2}([a-z0-9_]+)$/,n.PROPERTY_REGEX=/^[a-z_][a-z0-9_]*$/,n}(),i=a;i.getInstance();var o=[r],c=e.createElement.apply(void 0,function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))}([e.Fragment,null],o.map((function(t){return(0,e.createElement)(t)})),!1));(0,t.registerPlugin)("wp-parsely-tracks-js-events",{render:function(){return c}})}();